<!DOCTYPE html>
<html>
<head>
  <title>Developer Auth</title>
  <script src="https://www.google.com/recaptcha/api.js" async defer></script>
</head>
<body>
  <h2>Developer Login</h2>

  {% if error %}
    <p style="color:red;">{{ error }}</p>
  {% endif %}

  <form method="POST">
    <label>Password:</label><br>
    <input type="password" name="password" required><br><br>

    <!-- Google reCAPTCHA -->
    <div class="g-recaptcha" data-sitekey="{{ sitekey }}"></div><br>

    <button type="submit">Verify with Password</button>
  </form>

  <hr>

  <button onclick="authenticate()">Use Windows Hello (WebAuthn)</button>

  <p><a href="#">Forgot Password?</a> (Coming soon)</p>

  <script>
    async function authenticate() {
      try {
        const credential = await navigator.credentials.get({
          publicKey: {
            challenge: new Uint8Array(32),
            timeout: 60000,
            allowCredentials: [],
            userVerification: "preferred"
          }
        });
        alert("Fingerprint verified! (WebAuthn success â€” server check TBD)");
        window.location.href = "/dev";
      } catch (err) {
        alert("Fingerprint auth failed or cancelled.");
      }
    }
  </script>
</body>
</html>
