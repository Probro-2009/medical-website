<!-- templates/Newsletter.html -->
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Send Newsletter</title>
<style>
  :root{
    --bg:#0b1224; --panel:#0f172a; --accent:#22c55e; --muted:#9aa7bd; --text:#e5e7eb;
  }
  body{margin:0;background:linear-gradient(180deg,var(--bg),#0a0f1f);color:var(--text);
       font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial;}
  .wrap{max-width:960px;margin:40px auto;padding:0 16px}
  .card{background:var(--panel);border:1px solid rgba(255,255,255,.06);border-radius:18px;
        box-shadow:0 10px 30px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.03); padding:22px}
  h1{font-size:22px;margin:0 0 10px 0}
  .sub{color:var(--muted);font-size:13px;margin-bottom:18px}
  .grid{display:grid;gap:14px}
  label{font-size:13px;color:#cbd5e1}
  input[type="text"], textarea{
    width:100%; background:#0b1020; border:1px solid rgba(255,255,255,.08); color:var(--text);
    border-radius:12px; padding:12px 12px; outline:none; font-size:15px;
  }
  textarea{min-height:220px; resize:vertical; line-height:1.5}
  .row{display:flex; gap:12px; align-items:center; flex-wrap:wrap}
  .btn{
    background:linear-gradient(180deg,#22c55e,#16a34a); border:none; color:#06101a; font-weight:800;
    padding:12px 18px; border-radius:12px; cursor:pointer; letter-spacing:.2px;
    box-shadow:0 8px 18px rgba(34,197,94,.35);
  }
  .muted{color:var(--muted); font-size:13px}
  .pill{
    display:inline-flex; align-items:center; gap:8px; padding:8px 12px; border-radius:999px;
    background:rgba(34,197,94,.15); border:1px solid rgba(34,197,94,.4); color:#86efac; font-weight:700; font-size:12px
  }
  .alerts{margin-bottom:14px}
  .alert{
    border-radius:12px; padding:12px 14px; font-weight:700; margin-bottom:8px; font-size:14px
  }
  .alert.success{background:rgba(34,197,94,.15); border:1px solid rgba(34,197,94,.4); color:#86efac}
  .alert.error{background:rgba(239,68,68,.15); border:1px solid rgba(239,68,68,.4); color:#fecaca}
  .filebox{display:flex;align-items:center;gap:10px}
  input[type="file"]{
    padding:10px; background:#0b1020; border:1px dashed rgba(255,255,255,.15); border-radius:12px; color:#cbd5e1
  }
  .topbar{display:flex;justify-content:space-between;align-items:center;gap:10px;margin-bottom:12px;flex-wrap:wrap}
</style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="topbar">
        <div>
          <h1>Send Newsletter</h1>
          <div class="sub">Compose and send to all subscribers collected from the site.</div>
        </div>
        <div class="pill" title="Total subscribers">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M16 11c1.657 0 3-1.79 3-4s-1.343-4-3-4-3 1.79-3 4 1.343 4 3 4ZM8 11c1.657 0 3-1.79 3-4S9.657 3 8 3 5 4.79 5 7s1.343 4 3 4Zm0 2c-3.314 0-6 2.686-6 6v2h8.3a6.5 6.5 0 0 1 -.3-2c0-2.046.917-3.876 2.362-5.116C11.26 13.338 9.71 13 8 13Zm8 0c-3.866 0-7 3.134-7 7a7 7 0 1 0 7-7Z"/></svg>
          {{ total }} subscribers
        </div>
      </div>

      <div class="alerts">
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            {% for category, message in messages %}
              <div class="alert {{ category }}">{{ message }}</div>
            {% endfor %}
          {% endif %}
        {% endwith %}
      </div>

      <form action="{{ url_for('send_newsletter_action') }}" method="post" enctype="multipart/form-data" class="grid">
        <div>
          <label for="title">Title</label>
          <input id="title" name="title" type="text" placeholder="Newsletter title" required>
        </div>
        <div>
          <label for="body">Body</label>
          <textarea id="body" name="body" placeholder="Write your newsletter body..." required></textarea>
        </div>
        <div class="row">
          <div class="filebox">
            <label for="media">Optional media</label>
            <input id="media" name="media" type="file" accept="image/*,application/pdf,video/*,audio/*,.doc,.docx,.ppt,.pptx,.xls,.xlsx">
          </div>
          <button class="btn" type="submit">Send Newsletter</button>
        </div>
        <div class="muted">Gmail SMTP is used. Ensure <strong>SMTP_EMAIL</strong> and <strong>SMTP_PASSWORD</strong> are set in environment (use a Gmail App Password).</div>
      </form>
    </div>
  </div>
</body>
</html>
